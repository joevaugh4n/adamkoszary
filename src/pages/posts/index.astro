---
import Subpage from "../../layouts/Subpage.astro";
import Post from "../../components/Post.astro";
import { wpquery } from "../../lib/wordpress";

const data = await wpquery({
  query: `
      query GetPostExcerpts {
        posts {
          nodes {
            title
            dateGmt
            excerpt
            slug
            content
            tags {
              nodes {
                id
                name
              }
            }
            featuredImage {
              node {
                mediaItemUrl
                altText
              }
            }
          }
        }
      }
    `,
});

const posts = data.posts.nodes;
---

<Subpage description="All blog posts by Adam Koszary." title="All Posts">
  <h1 class="mt-20 mb-8 text-4xl uppercase">POSTS</h1>
  <section class="grid grid-cols-2">
    {console.log(posts)}
    {
      posts.map((post: any) => (
        <Post
          slug={post.slug}
          title={post.title.rendered}
          date={post.dateGmt}
          prose={post.excerpt}
          tags={post.tags.nodes}
        />
      ))
    }
  </section>
</Subpage>
